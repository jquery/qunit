QUnit for Google Apps Script
===============================================================
[QUnit for Google Apps Script](https://github.com/simula-innovation/qunit/tree/gas/gas)
is an experimental fork of [QUnit](http://qunitjs.com) that enables
developers to test their [Google Apps Script](https://developers.google.com/google-apps/) code.

For more information about QUnit, read the main [README](https://github.com/jquery/qunit).

API docs are available [here](https://script.google.com/macros/library/versions/d/MxL38OxqIK-B73jyDTvCe-OBao7QLBR4j).

Example Use in Google Apps Script
-----------------------------
QUnit for Google Apps Script is made available as a script
library. This is how you add it to your project:

1. Select "Resources" > "Manage Libraries..." in the Google Apps
Script editor.
2. Enter the project key (`MxL38OxqIK-B73jyDTvCe-OBao7QLBR4j`) in the
"Find a Library" field, and choose "Select".
3. Select the highest version number, and choose QUnit as the
identifier. (Do not turn on Development Mode unless you know what you
are doing. The development version may not work.)
4. Press Save. You can now use the QUnit library when writing your
tests. You can see a list of available functions by typing QUnit
followed by a dot. Alternatively, read the [API docs](https://script.google.com/macros/library/versions/d/MxL38OxqIK-B73jyDTvCe-OBao7QLBR4j).

Differences from regular QUnit
---------------------------
QUnit for Google Apps Script has the following differences compared to
the regular, in-browser QUnit:

- The published QUnit library functions are in a separate file for the
  library creation and API documentation generation to work.
- Tests are run on Google's servers, not in your browser. The browser
only displays test results.
- Configuration is not made by setting `QUnit.config`, but by calling
  `QUnit.config(myConfig)`, where `myConfig` is an object with your
  configuration settings.
- HTML and client-side JavaScript is generated using Google's [HtmlService](https://developers.google.com/apps-script/class_htmlservice).
  For this to work, the HTML and JavaScript generated by QUnit needs
  to be compatible with [Caja](https://caja.appspot.com).
- The Google Apps Script service running the tests needs to implement
  a `doGet(e)` function that:
  1. calls `QUnit.urlParams(e.parameter)`, which ensures that
    QUnit-specific HTTP parameters are handled when you interact with
    the QUnit GUI;
  2. optionally, configures QUnit with the `QUnit.config()` function;
  3. loads tests with `QUnit.load(myTests)`, where `myTests` is a
    function containing your tests or calls to other functions
    containing your tests;
  4. returns the result of `QUnit.getHtml()`;
- The GUI is not displayed immediately, but rather only after the
  tests have run.
- Stack traces display library IDs and script file IDs rather than
  file names.
- Interaction with the form elements leads to form submission instead
  of changing `window.location`. (The latter does not work with Google
  Apps Script.)
- Double clicks on tests are disabled. Click on the Rerun link instead.
- There are also additional configuration parameters:
  - `title`: a string to use as title.
  - `hidepassed`: a boolean indicating whether passed tests should be
    hidden by default.
  - `cssUrl`: a URL pointing to an alternative CSS file, for example:
    - `'https://raw.github.com/jquery/qunit/master/addons/themes/gabe.css'`
    - `'https://raw.github.com/jquery/qunit/master/addons/themes/nv.css'`
  - `reverse`: a boolean indicating whether tests should be listed in
    reverse order.
- Asynchronous testing is limited. There is no `setTimeout()` function
  in Google Apps Script. If you create time-based triggers via the
  `Script` service, the `doGet()` function is more likely to timeout
  than your test.
- There are no global QUnit functions by default, but some helper
  functions can be imported from QUnit to the test suite by calling
  `QUnit.helpers(this)`.
- Some QUnit functions and objects that are not available at the
  library level can be accessed with the `QUnit.internals()`
  function. This is for testing QUnit itself.
- The QUnit object can be accessed by calling `QUnit.getObj()`.
  This is for testing QUnit itself.

Development in Google Apps Script
-----------------------------
To create your own development version of QUnit for Google Apps
Script, click [here](https://script.google.com/d/13agWuzcPH32W4JJvOqOEYqeNHGihS63P2V-a-Vxz-c9WPIzZYBvIhs3m/edit)
and choose "File" > "Make a copy..." in the Google Apps Script editor.

To edit the source code offline, check out the "gas" branch of the
[git repository](https://github.com/simula-innovation/qunit/tree/gas).

Note that the Google Apps Script editor uses 2 space characters for
indenting, while `qunit.js` has tab characters. If you want to submit
patches for `qunit.js`, edit the code in an editor that indents with
tab characters. The files in the `gas/` folder use 2 space characters
for indenting.

Before submitting patches, test your code in Google Apps Script and
offline with `grunt`. Instructions for the latter can be found
[here](https://github.com/jquery/qunit).

There are currently no `grunt` tasks for the Google Apps Script
version of QUnit.

Example Tests
-------------
Here are some example tests using QUnit for Google Apps Script:

- QUnit
  ([run](https://script.google.com/a/macros/simula.no/s/AKfycbzjTdrcXIF-kXYwy2TPSRrg0EukONGXkVUOa6kSOwC9N9hqlOg/exec),
  [source](https://github.com/simula-innovation/qunit/tree/gas/gas/test),
  [test project](https://script.google.com/d/1rIAyP5YaTZQdON3QyU0NWLWiXrc-9hvrzMUw8Iz7lOJZxK1dgpkHcZa5/edit),
  [project under test](https://script.google.com/d/13agWuzcPH32W4JJvOqOEYqeNHGihS63P2V-a-Vxz-c9WPIzZYBvIhs3m/edit))

Releases
---------
To use the latest release, follow the instructions for "Example Use in
Google Apps Script" mentioned above, only skipping step 2.
